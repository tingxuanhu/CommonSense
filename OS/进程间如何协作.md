# 进程间协作

## 进程通信

### 共享存储 Shared-Memory（早期实现方式）
- 我不能去你家，你不能来我家，但可以到一个共享的广场上去交流
    - 共用OS提供并控制的数据结构
        - OS已经配置好了的结构
        - 操作底层的 传递数据少
    - 共享内存中的一块存储区
        - 进程需要时动态地向OS去申请
        - 传递数据多
- 多进程使用同一块空间（公共数据），数据收发双方不可见 --> 有**安全隐患**

### 消息传递 Message-Passing
- 发消息用send原语  接收用receive原语
    - 点对点发送
        - 消息有固定格式（格式化消息）：
            - 消息头
            - 发/收PID
            - 消息类型、长度
            - 消息体
        - 发送和接收时指明双方PID
        - 每个进程维护一个消息缓冲队列

    - 广播信箱 （间接）
        - 找信箱作为媒介
        - 发到信箱里，收信从信箱中取
        - 可以广播，容易建立双向通信链

### 管道通信 Pipe
- 管道是一个固定大小的缓冲区（pipe共享文件）  单向流动
    - A进程写入管道只能由B进程读 而A不能从同一个管道中读取B写入的数据
    - 双工通信需要两个管道
    - 以队列FIFO组织数据传输
    - 未满不读  已满不写  未空不写  已空不读  读后删除（管道中同时只做一件事，互斥操作）
    - 通过系统调用write()/read() 去读写


## 进程同步
指的是让若干进程按想要的规则和秩序去执行的过程
- 前提是
    - 进程通信
    - 并发进程对系统的共享资源进行竞争

- 同步
    - 与互斥的区别在于 虽然进程相互制约但目的是合作（比如管道通信，读的时候不能写）

- 互斥
    - 与同步的区别在于 进程排他性地访问共享资源


